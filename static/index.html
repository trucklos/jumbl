<!DOCTYPE html>

<html lang="en">
<head>
	<title>mapthing</title>

	<link type="text/css" rel="stylesheet" href="css/reset.css">
    <link type="text/css" rel="stylesheet" href="css/style.css">
    
    <!--[if lt IE 9]> <script src="js/html5shiv.js"></script> <![endif]-->

	<!-- Leaflet css -->
	<link rel="stylesheet" href="leaflet-0.3.1/leaflet.css">
	<!--[if lte IE 8]>  <link rel="stylesheet" href="http://code.leafletjs.com/leaflet-0.3.1/leaflet.ie.css" /><![endif]-->

	<script src="leaflet-0.3.1/leaflet.js"></script>
	<script src="js/jquery-1.7.2.js"></script>
	<script src="js/mapthing.js"></script>

	<script>		
		
		currentPath = null;
		userid = null;
		
		function submitPathForm(){
			MapThing.createPath($("#createpathdesc").val(), userid);
		}

		$(document).ready(function() {
			MapThing.initMap('map');

			var gid = MapThing.getQueryVariable("gid",-1);
			var userid = -1;

			$.getJSON('django/api/fetchbygid/' + gid, function(data) {
  				userid = data[0].id;
  				var url = 'django/api/users/'+userid;
  				alert(url);
  				$.getJSON(url, function(user){
					MapThing.loadUserPathList(user.paths);
				});
   			});
		});
	</script>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-31831588-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</head>
<body>

<header id="body-header">
	<div class="inner">
		<h1>mapthing | alpha</h1>
	</div>
</header>	

<div id="body-content">
	<div>
		<div id="map" style="height: 400px; width: 100%;"></div>
		
		<div class="info-box">
			<div id="directions">
				<strong>Enter an adventure name below and click 'create'.  Double click the map to add points to your adventure.</strong>
			</div>
			<form name="pathform">
				<input type="text" name="createpathdesc" id="createpathdesc" />
				<input type="button" name="createpathbutton" id="createpathbutton" value="create" onClick="submitPathForm()" />
			</form>
			<ul id="userlist"> 
				<!--<li>Placeholder</li>-->
			</ul>
		</div>
	</div>
</div>

<footer id="body-footer"></footer>

</body>
</html>
